/*
* Arkansas County Map in HTML5
* Originally written by Joseph Utecht
* joseph.utecht@arkansas.gov
*
* County coordinates were originally transcribed by Sonya Utecht
* sonya.utecht@arkansas.gov
*
* This will attempt to draw all of the counties in a canvas element id='c'
* Make sure the element is declared in this way
* <canvas id="c" width="900" height="900"/>
* you can later resize it using CSS
*/

// Used later in code, don't change
var hooverCounty = "";
// this is the base color for the counties
var baseColor = "#19296B";
// this is the color of the county currently moused over
var highlightColor = "#081446";

function County(name, url, coords){
    this.name = name;
    this.url = url;
    this.coords = coords;
    
    // find center
    var centerX = 0.0;
    var centerY = 0.0;
    var signedArea = 0.0;
    var x0 = 0.0;
    var y0 = 0.0;
    var x1 = 0.0;
    var y1 = 0.0;
    var a = 0.0;
    for(i = 0; i < this.coords.length - 2; i += 2){
        x0 = this.coords[i];
        y0 = this.coords[i + 1];
        x1 = this.coords[i + 2];
        y1 = this.coords[i + 3];
        a = x0 * y1 - x1 * y0;
        signedArea += a;
        centerX += (x0 + x1) * a;
        centerY += (y0 + y1) * a;
    }
    signedArea *= .5;
    centerX /= (6*signedArea)
    centerY /= (6*signedArea)
    this.cX = parseInt(centerX)
    this.cY = parseInt(centerY)
            
    this.draw = function(c){
        c.beginPath()
        c.moveTo(this.coords[0], this.coords[1])
        for(i = 2; i < this.coords.length; i += 2){
            c.lineTo(this.coords[i], this.coords[i+1]);
        }
        // set fill style to random color
        //c.fillStyle = '#'+Math.floor(Math.random()*16777215).toString(16);
        c.fillStyle = baseColor;
        c.strokeStyle = "black";
        c.lineWidth = 2;
        if(hooverCounty == this.name){
            c.fillStyle = highlightColor;
            c.strokeStyle = "white";
            c.lineWidth = 5;
        }
        c.stroke();
        c.fill();
    }
    
    this.drawName = function(c){
        c.fillStyle = "white";
        c.font = "12pt helvetica georgia sans-serif";
        c.fillText(this.name, this.cX - (3 * this.name.length), this.cY);
    }
    
    // returns true if county contains x, y point
    // uses ray casting intersection method described here
    // http://paulbourke.net/geometry/insidepoly/
    this.contains = function(x, y){
        count = 0;
        for(i = 2; i <= this.coords.length - 2; i += 2){
            ax = this.coords[i];
            ay = this.coords[i + 1];
            bx = this.coords[i + 2];
            by = this.coords[i + 3];
            if(y > Math.min(ay, by)){
                if(y <= Math.max(ay, by)){
                    if(x <= Math.max(ax, bx)){
                        if(ay != by){
                            xint = (y-ay) * (bx-ax) / (by - ay) + ax;
                            if(ax == bx || x <= xint){
                                count++;
                            }
                        }
                    }
                }
            }
        }
        if (count % 2 == 0){
            return false;
        } else {
            return true;
        }
    }
}

counties = new Array();
counties.push(new County("Benton", ".", [6, 4 ,135,4, 135,63 ,110,63 ,110,70 ,50,70, 50,80, 40,80, 40, 90, 13,90, 6, 4]));
counties.push(new County("Carroll", ".",[136,5, 240, 9, 236,91,215,92, 213, 89, 204, 87, 204, 89, 192, 88, 191, 83, 189, 83, 185, 77, 177, 78, 179, 74, 181, 70, 182, 59, 178, 60, 178, 55, 174, 56, 170, 50, 135, 49, 136, 5]));
counties.push(new County("Boone", ".", [241,10, 236, 92, 311,94, 312, 10 , 241, 10]));
counties.push(new County("Marion", ".", [313,10 ,377,10, 375, 15, 374, 33, 368, 38, 367, 42, 377, 58, 385, 64, 385, 78,396, 84, 398, 107, 321,104, 320, 95,312,95, 313, 10]));
counties.push(new County("Baxter", ".", [378,10, 444, 10, 441,80,432,81,431,91,434,95,434,105,418, 105,413, 123,396, 125,396,85,384,78,385, 64,369,48,367,40, 375,35,376,16,378,11 , 378, 10]));
counties.push(new County("Fulton", ".", [445, 11,568,10,568,45, 550,45,550, 64, 443, 62, 445, 11]));
counties.push(new County("Randolph", ".", [581,11,690, 9, 690,19, 696, 26, 694, 54,694, 52, 685, 82, 641, 85, 637, 89,605, 64, 604, 45, 601, 45, 599, 31, 594, 32,595, 25, 588, 25,586,16, 581, 11]));
counties.push(new County("Clay", ".", [690,10, 801,9,807,23,813,31,813,43,796,71,772,71,772,59,687,59,687,53,695,53,695,27 , 690, 10]));
counties.push(new County("Washington", ".", [14,90,35,90, 39,92,39,81,49,81,53,69,109,71,109,65,133,64,119,100,117,151,113,169,57,169,57,167,23,168, 14, 90]));
counties.push(new County("Madison", ".", [135,49,169,49,172,55,179,55,179,61,183,58,181,70,178,73,186,78,188,82,191,83,191,89,204,89,204,100,211,100,211,117,205,127,200,127,195,145,194,155,194,169,166,167,127,167,114,169,118,152,121,100,134,64, 135, 49]));
counties.push(new County("Newton", ".", [205,88,215,92,300,93,301,181, 249, 181,210,177,210,177,196,176, 194, 157, 200,128,205,128, 210,118,212,101,203,100, 205, 88]));
counties.push(new County("Searcy", ".", [300,93,319,95, 321,104,396,106,397,166,358,166,355,184,301,181, 300, 93]));
counties.push(new County("Stone", ".", [398,125,414,124,416,106,435,105,435,95,445,95,457,108,450,116,454,123,452,134,460,132,466,136,482,136,497,147,495,164,498,186,395,183, 398, 125]));
counties.push(new County("Izard", ".", [444, 62,526,64,527, 73,530, 73, 527, 119,523, 119, 522, 131,514,132,498,147,482,136,468,135,460,133,456,134,451,134,453,124,451,117,456,109,446,95,436,95,431,89,432,81,440, 80, 444, 62]));
counties.push(new County("Sharp", ".", [570, 10,580, 10,586, 16, 588, 24,594, 24, 595, 31, 600, 31, 601, 44, 604, 45, 604, 64, 592, 64, 590, 69, 587, 69, 588, 143, 567, 144, 567, 132, 523, 132, 523, 119, 528, 119, 529, 73, 527, 73, 527, 64, 549, 65, 550, 45, 569, 44, 570, 10]));
counties.push(new County("Lawrence", ".", [586, 68, 591, 69, 593, 64, 605, 64, 636, 88, 641, 84, 692, 84,693, 88, 680, 111, 678, 125, 673, 138, 649, 144, 589, 144, 586, 68]));
counties.push(new County("Greene", ".", [688,60,771,59,772,71,794,72,759,123,679, 123, 680,110,693,89,694,84,685,84, 688, 60]));
counties.push(new County("Crawford", ".", [23,169,55, 169,56, 170,125, 168,128, 172,124, 171,123,174,118,174,116, 179,112, 180,112, 188, 94, 191, 94, 210, 103, 210, 103, 225, 93, 237, 81, 238, 81, 248, 77, 253, 70, 254, 61, 258, 53, 258, 37, 238, 32, 239, 23, 169]));
counties.push(new County("Franklin", ".", [128, 167, 163,167,161,251,151,256,142,249,142,267,121,268,120,286,109,289,91,288,93,237,102,223,101,210,94,210,94,192,112,189,112,180,116,180,118,174,124,173,125,171,128,171, 128, 167]));
counties.push(new County("Johnson", ".", [164,168,193,170,195,176,210,176,247,177,250,179,260,181,259,204,250,206,248,234,236,235,235,255,234,256,233,265,222,265,209,252,206,246,193,251,187,250,178,254,165,251,161,253, 164, 168]));
counties.push(new County("Pope", ".", [261,181,325,182,324,219,318,219,318,239,314,240,314,304,282,304,278,313,274,310,269,301,267,302,236,269,235,257,236,254,236,235,248,235,250,206,260,205, 261, 181]));
counties.push(new County("Van Buren", ".", [325,183,355,183,358,166,395,166,396,183,428,185,425,261,385,259,384,240,318,239,318,219,325,218, 325, 183]));
counties.push(new County("Cleburne", ".", [428,185,501,186,507,183,508,240,499,245,497,263,426,262, 428, 185]));
counties.push(new County("Independence", ".", [514,132,566,132,566,143,613,143,612,154,596,170,589,191,593,199,586,199,584,223,508,222,508,183,499,187,495,166,498,148, 514, 132]));
counties.push(new County("Jackson", ".", [613,144,645,144,645,262,606,261,606,242,547,242,547,223,584,223,585,200,591,199,590,184,596,170,611,151, 613, 144]));
counties.push(new County("Craighead", ".", [680,124,759,125,780,119,780,181,646,181,647,144,671,140,674,138, 680, 124]));
counties.push(new County("Poinsett", ".", [646,181,780,181,782,240,723,242,723,237,703,237,702,242,647,242, 646, 181]));
counties.push(new County("Mississippi", ".", [781,120,878,119,892,130,893,137,877,137,874,143,881,150,881,154,861,165,848,165,840,175,846,187,857,192,846,202,841,207,848,218,844,220,832,211,827,215,826,244,817,233,806, 241,782,240, 781, 120]));
counties.push(new County("Sebastian", ".", [31,239,35,237,52,256,59,258,69,254,78,254,81,247,82,238,93,238,91,289,101,290,101,307,79,307,78,313,61,326,64,328,63,346,36,347,24,353, 31, 239]));
counties.push(new County("Logan", ".", [101, 289,120,286,120,269,142,268,143,251,151,256,165,252,176,255,188,249,193,252,203,246,208,248,221,266,233,266,236,270,235,292,200,292,188,307,158,310,158,335,91,332,82,326,79,307,99,308, 101, 289]));
counties.push(new County("Conway", ".", [316,239,383,240,383,276,375,289,376,304,379,310,356,325,350,319,345,327,283,326,280,314,282,305,313,305, 316, 239]));
counties.push(new County("Faulkner", ".", [385,260,447,263,446,341,429,341,428,358,396,359,386,373,384,372,381,362,362,341,370,330,370,316,379,311,377,303,377,289,383,276, 385, 260]));
counties.push(new County("White", ".", [509,222,546,222,547,242,589,242,587,251,573,267,582,285,582,298,576,299,568,324,546,323,545,336,533,336,525,328,496,336,485,336,469,329,448,329,448,263,494,263,498,249,507,240, 509, 222]));
counties.push(new County("Woodruff", ".", [588,242,605,243,606,262,646,263,646,340,607,345,608,346,600,347,601,345,598,363,587,362,587,332,569,330,568,321,573,302,581,299,582,285,573,272,574,261,587,251, 588, 242]));
counties.push(new County("Cross", ".", [645,242,703,242,704,237,722,238,723,241,744,243,744,309,646,309, 645, 242]));
counties.push(new County("St. Francis", ".", [647,309,759,309,759,361,638,361,637,372,629,373,625,362,626,343,645,341, 647, 309]));
counties.push(new County("Crittenden", ".", [744,242,804,241,800,250,812,252,818,257,804,274,805,281,819,290,821,306,818,309,811,307,795,330,781,337,780,347,787,355,784,368,778,374,761,368,760,309,744,308, 744, 242]));
counties.push(new County("Scott", ".", [24,352,35,347,64,346,64,328,61,325,79,314,81,324,91,331,157,334,157,394,124,407,124,413,46,405, 45,399,21,399, 24, 352]));
counties.push(new County("Yell", ".", [158,310,188,307,200,292,236,293,236,271,251,280,267,301,270,302,272,311,279,314,282,323,234,374,233,391,215,392,214,398,158,396, 158, 310]));
counties.push(new County("Perry", ".", [282,323,283,326,345,328,349,319,355,326,356,326,370,317,371,332,363,340,373,356,351,356,353,363,332,364,333,382,325,375,276,374,273,391,235,391,234,373, 282, 323]));
counties.push(new County("Saline", ".", [273,391,276,374,325,374,333,383,333,374,350,377,351,394,370,395,369,411,389,414,389,425,406,425,407,435,424,438,424,455,397,456,396,464,361,464,360,469,354,469,355,476,342,474,343,459,334,458,333,453,326,453,326,440,321,435,307,431,307,426,293,422,288,410,291,411,291,392,274,391, 273, 391]));
counties.push(new County("Pulaski", ".", [331,363,353,363,352,357,374,356,381,363,383,371,387,371,394,359,429,358,428,341,456,341,456,398,446,426,462,427,464,456,424,455,424,437,407,435,407,424,389,425,389,415,371,411,369,395,352,394,351,377,335,373, 331, 363]));
counties.push(new County("Lonoke", ".", [447,329,468,328,482,335,504,335,504,362,526,361,526,416,534,423,534,442,528,459,465,456,461,427,446,424,456,398,456,340,447,340, 447, 329]));
counties.push(new County("Prairie", ".", [505,334,526,328,532,335,545,335,546,323,567,323,569,331,587,332,587,363,585,368,588,368,584,415,572,416,572,429,577,429,577,435,584,435,584,439,543,438,542,458,529,458,529,453,536,438,535,424,525,415,526,361,505,361, 505, 334]));
counties.push(new County("Monroe", ".", [587,362,599,363,601,347,608,346,625,343,626,362,630,361,630,372,637,372,637,390,634,402,644,401,644,458,654,459,655,489,644,489,634,486,629,478,622,473,621,466,615,466,613,460,603,452,601,439,585,439,585,434,576,435,577,428,572,429,572,417,585,416,587,369,585,369, 587, 362]));
counties.push(new County("Lee", ".", [638,361,760,361,760,367,749,369,751,397,740,389,735,395,737,405,746,410,743,421,733,411,727,420,643,421,643,401,633,401,637,388, 638, 361]));
counties.push(new County("Polk", ".", [21,399,45,399,45,404,116,411,111,487,55,482,55,502,57,504,58,518,16,516, 21, 399]));
counties.push(new County("Montgomery", ".", [118,411,124,414,124,406,158,395,212,398,209,488,112,487, 118, 411]));
counties.push(new County("Garland", ".", [215,392,290,392,290,410,288,410,292,422,306,426,306,431,321,434,325,440,325,452,301,454,300,464,294,464,294,477,210,475,212,399,215,399, 215, 392]));
counties.push(new County("Hot Spring", ".", [210,475,294,477,295,464,301,464,301,454,333,453,334,459,343,459,343,475,347,475,342,532,275,527,275,522,278,516,272,510,246,510,245,501,219,502,218,490,209,489, 210, 475]));
counties.push(new County("Grant", ".", [348,475,356,476,355,469,360,469,360,463,398,463,397,456,430,456,430,514,425,516,425,552,401,552,379,534,342,532, 348, 475]));
counties.push(new County("Jefferson", ".", [430,455, 522,459,520,514, 552,517,558,534,570,539,570,547,556,547,552,544,542,543,540,533,533,537,524,529,519,530,520,550,517,551,516,545,477,546,477,552,427,552,426,516,428,514, 430, 455]));
counties.push(new County("Arkansas", ".", [542,439,600,441,602,451,614,460,615,466,621,466,620,472,630,476,635,487,643,490,642,499,638,531,631,538,620,546,618,558,625,569,625,581,616,576,602,573,590,575,596,567,581,569,571,547,570,538,559,534,552,517,520,515,521,458,543,459, 542, 439]));
counties.push(new County("Phillips", ".", [643,422,726,421,729,432,735,438,730,448,729,466,714,488,705,479,700,485,697,500,685,502,681,510,669,510,665,518,673,526,685,526,686,532,665,531,661,538,633,536,637,530,640,505,645,489,654,489,656,458,643,457, 643, 422]));
counties.push(new County("Sevier", ".", [16,517,78,519,87,570,87,587,102,605,102,619,91,619,88,614,72,613,63,611,59,607,45,604,45,599,27,586,27,578,13,574, 16, 517]));
counties.push(new County("Howard", ".", [55,482,112,486,113,522,133,522,128,619,104,620,103,605,88,586,88,570,79,521,57,518,57,506,52,503, 55, 482]));
counties.push(new County("Pike", ".", [112,486,196,489,198,498,192,507,192,512,203,522,199,532,199,542,215,574,191,574,189,577,181,572,170,571,167,567,147,562,133,561,133,522,114,521,113,503,111,502, 112, 486]));
counties.push(new County("Clark", ".", [196,489,218,490,218,501,245,501,245,509,271,510,278,516,276,528,305,531,304,568,290,568,300,587,301,607,293,607,278,616,265,614,256,607,247,607,223,590,218,579,201,544,200,529,204,525,191,509,199,499, 196, 489]));
counties.push(new County("Dallas", ".", [307,531,379,536,403,552,383,552,382,573,392,581,395,591,406,600,406,612,299,608,298,587,290,569,302,568, 307, 531]));
counties.push(new County("Cleveland", ".", [382,552,476,553,478,571,473,571,471,631,471,631,408,633,406,599,396,589,392,581,381,573, 382, 552]));
counties.push(new County("Lincoln", ".", [477,546,516,546,515,550,520,550,519,530,523,529,533,537,540,532,543,543,554,544,559,546,570,547,575,563,566,563,565,572,552,572,550,614,472,614,472,572,477,571, 477, 546]));
counties.push(new County("Desha", ".", [552,572,566,571,566,563,576,563,579,568,586,568,594,565,595,568,590,573,600,574,611,573,621,580,625,580,627,569,618,560,619,548,630,537,660,537,669,547,672,556,660,558,658,571,643,564,636,565,636,575,642,582,642,601,654,612,649,616,630,615,626,622,634,631,642,632,642,641,631,637,619,630,612,637,612,645,622,653,612,658,608,662,607,671,605,674,590,673,588,663,571,663,570,615,551,614, 552, 572]));
counties.push(new County("Little River", ".", [14,575,27,577,27,587,45,598,45,604,58,607,72,613,87,613,92,620,103,620,103,635,113,642,114,648,126,649,94,661,81,654,65,653,54,657,47,654,35,657,27,657,12,640, 14, 575]));
counties.push(new County("Hempstead", ".", [104,620,128,618,133,562,145,561,170,571,182,572,189,576,189,574,200,575,191,681,175,681,172,679,148,680,142,670,132,663,127,650,121,648,114,648,113,642,103,635, 104, 620]));
counties.push(new County("Nevada", ".", [200,574,215,574,225,593,242,604,247,607,257,607,262,614,259,686,242,690,203,689,190,688, 200, 574]));
counties.push(new County("Ouachita", ".", [263,615,274,617,293,608,358,609,358,626,345,641,335,642,334,651,338,661,325,667,325,679,333,682,337,690,350,698,361,707,347,708,332,703,322,706,316,706,314,704,259,701, 263, 615]));
counties.push(new County("Calhoun", ".", [359,610,406,612,408,677,404,696,397,705,400,721,390,729,379,721,356,700,343,696,336,682,332,681,325,679,325,665,337,661,338,659,333,646,340,642,345,640,357,626, 359, 610]));
counties.push(new County("Bradley", ".", [408,633,473,632,472,670,468,685,474,707,470,721,449,738,443,742,443,752,438,752,432,745,426,740,426,731,408,725, 400, 720, 398,709,398,705,405,697,408,677, 408, 633]));
counties.push(new County("Drew", ".", [472,614,570,614,569,700,473,700,468,691,468,678,472,669, 472, 614]));
counties.push(new County("Miller", ".", [93,662,126,651,129,661,143,672,147,679,149,699,154,717,145,726,148,731,140,754,121,756,116,763,125,779,90,779, 93, 662]));
counties.push(new County("Lafayette", ".", [148,680,171,680,174,681,192,681,191,688,212,690,199,730,189,731,189,781,125,779,118,761,122,757,139,754,146,744,149,730,145,727,154,720,149,697, 148, 680]));
counties.push(new County("Columbia", ".", [213,690,241,690,242,687,258,687,259,702,284,704,283,782,190,781,189,731,200,730, 213, 690]));
counties.push(new County("Union", ".", [286,704,314,703,318,707,322,707,331,703,337,704,344,708,362,708,374,719,379,720,387,727,393,728,400,722,418,730,427,731,427,741,433,744,439,752,443,752,443,760,440,766,448,784,283,782, 286, 704]));
counties.push(new County("Ashley", ".", [473,702,568,702,567,783,448,783,442,765,444,759,443,742,450,739,463,727,468,724,472,719,473,710,475,707, 473, 702]));
counties.push(new County("Chicot", ".", [571,663,589,663,589,673,606,673,609,664,615,675,608,687,611,692,616,691,626,684,626,689,618,698,618,704,626,705,638,695,641,698,629,715,628,724,641,730,635,743,634,757,620,757,617,763,625,773,626,782,622,783,567,783, 571, 663]));

function draw(){
    var canvas = document.getElementById('c');
    var c = canvas.getContext('2d');
    c.clearRect(0, 0, canvas.width, canvas.height)
    for(x = 0; x < counties.length; x++){
        counties[x].draw(c);
    }
    // redraw the hoovered county to make sure border isn't overlapped
    for(x = 0; x < counties.length; x++){
        if(counties[x].name == hooverCounty){
            counties[x].draw(c);
        }
        counties[x].drawName(c);
    }
}

function hoover(x, y){
    newhooverCounty = "";
    for(c = 0; c < counties.length; c++){
        if(counties[c].contains(x, y)){
            newhooverCounty = counties[c].name;
            break;   
        }
    }
    // only redraw map if a new county is being hoovered over
    if(newhooverCounty != hooverCounty){
        hooverCounty = newhooverCounty;
        draw();
    }
}

function click(x, y){
    for(c = 0; c < counties.length; c++){
        if(counties[c].contains(x, y)){
            window.location=counties[c].url;
            break;   
        }
    }
}

$(document).ready(function(){
    draw();
    // find the scale needed to offset the mouse positions
    var scale = 900 / $("#c").height();
    // bind mouse move/click on canvas
    $('#c').mousemove(function(e){
        // fix firefox for being stupid
        var offX, offY;
        if(!(e.offsetX || e.offsetY)){
            offX = e.layerX - e.target.offsetLeft;
            offY = e.layerY - e.target.offsetTop;
        } else {
            offX = e.offsetX;
            offY = e.offsetY;
        }
        hoover(parseInt(offX * scale), parseInt(offY * scale));
    });
    $('#c').click(function(e){
        // fix firefox for being stupid
        var offX, offY;
        if(!(e.offsetX || e.offsetY)){
            offX = e.layerX - e.target.offsetLeft;
            offY = e.layerY - e.target.offsetTop;
        } else {
            offX = e.offsetX;
            offY = e.offsetY;
        }
        click(parseInt(offX * scale), parseInt(offY * scale));
    });
});